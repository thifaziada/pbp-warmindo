{"version":3,"names":["STATES","HIDDEN","ANIMATING","SHOWN","EASING","Easing","bezier","SCREEN_INDENT","Tooltip","React","forwardRef","incomingProps","ref","props","useDefaultProps","animationDuration","bg","color","p","rounded","mx","minW","zIndex","fontSize","useNativeDriver","container","useRef","state","setState","useStateCallback","visible","top","left","menuWidth","menuHeight","buttonWidth","buttonHeight","marginAnimation","Animated","Value","opacityAnimation","windowHeight","WINDOW_HEIGHT","StatusBar","currentHeight","invert","shadowMenuContainerStyle","opacity","marginTop","text","style","children","rest","animationStarted","modalVisible","theme","useTheme","computedStyle","getStyle","onDismiss","show","current","measureInWindow","parallel","timing","toValue","duration","easing","start","hide","useImperativeHandle","StyleSheet","absoluteFill","styles","shadowMenuContainer","triangle","create","position","backgroundColor","borderRadius","width","menuContainer","overflow"],"sources":["tooltip.component.tsx"],"sourcesContent":["import * as React from 'react';\nimport { useRef, useImperativeHandle } from 'react';\nimport {\n  View,\n  Modal,\n  Easing,\n  Animated,\n  StatusBar,\n  StyleSheet,\n  TouchableWithoutFeedback,\n} from 'react-native';\n\nimport { getStyle } from './tooltip.style';\nimport { useTheme } from '../../theme';\nimport { Text } from '../text/text.component';\nimport { Triangle } from './triangle.component';\nimport { TooltipProps, TooltipRef } from './tooltip.type';\nimport { useStateCallback, WINDOW_HEIGHT } from '../../utilities';\nimport { useDefaultProps } from '../../utilities/useDefaultProps';\n\nconst STATES = {\n  HIDDEN: 'HIDDEN',\n  ANIMATING: 'ANIMATING',\n  SHOWN: 'SHOWN',\n};\n\nconst EASING = Easing.bezier(0.4, 0, 0.2, 1);\nconst SCREEN_INDENT = 8;\n\nconst Tooltip = React.forwardRef<\n  TooltipRef,\n  React.PropsWithChildren<TooltipProps>\n>((incomingProps, ref) => {\n  const props = useDefaultProps('Tooltip', incomingProps, {\n    animationDuration: 300,\n    bg: 'gray900',\n    color: 'white',\n    p: 'md',\n    rounded: 'xl',\n    mx: 'lg',\n    minW: 50,\n    zIndex: 1,\n    fontSize: 'md',\n    useNativeDriver: false,\n  });\n\n  const container = useRef<View>(null);\n  const [state, setState] = useStateCallback({\n    visible: STATES.HIDDEN,\n    top: 0,\n    left: 0,\n    menuWidth: 0,\n    menuHeight: 0,\n    buttonWidth: 0,\n    buttonHeight: 0,\n    marginAnimation: new Animated.Value(-8),\n    opacityAnimation: new Animated.Value(0),\n  });\n  const {\n    visible,\n    menuHeight,\n    buttonHeight,\n    opacityAnimation,\n    marginAnimation,\n  } = state;\n  let { top } = state;\n  const windowHeight = WINDOW_HEIGHT - (StatusBar.currentHeight ?? 0);\n  let invert = false;\n  if (top + menuHeight + buttonHeight + SCREEN_INDENT > windowHeight) {\n    top = top - menuHeight - SCREEN_INDENT;\n    invert = true;\n  } else if (top < SCREEN_INDENT) {\n    top = SCREEN_INDENT + buttonHeight;\n  } else {\n    top = top + buttonHeight + SCREEN_INDENT;\n    invert = false;\n  }\n  const shadowMenuContainerStyle = {\n    opacity: opacityAnimation,\n    top,\n    marginTop: marginAnimation,\n  };\n  const {\n    text,\n    style,\n    children,\n    bg,\n    animationDuration,\n    useNativeDriver,\n    ...rest\n  } = props;\n  const animationStarted = visible === STATES.ANIMATING;\n  const modalVisible = visible === STATES.SHOWN || animationStarted;\n  const { theme } = useTheme();\n  const computedStyle = getStyle(theme, props, {\n    ...state,\n    invert,\n  });\n\n  /**\n   * on dismissal of tooltip\n   *\n   * TODO: add onDismiss event\n   */\n  const onDismiss = () => {};\n\n  /**\n   * shows the tooltip\n   */\n  const show = () => {\n    if (container.current) {\n      container.current.measureInWindow(\n        (left: any, top: any, buttonWidth: any, buttonHeight: any) => {\n          setState(\n            {\n              ...state,\n              buttonHeight,\n              buttonWidth,\n              left,\n              visible: STATES.SHOWN,\n              top,\n            },\n            () => {\n              Animated.parallel([\n                Animated.timing(state.marginAnimation, {\n                  toValue: 0,\n                  duration: animationDuration,\n                  easing: EASING,\n                  useNativeDriver: useNativeDriver!,\n                }),\n                Animated.timing(state.opacityAnimation, {\n                  toValue: 1,\n                  duration: animationDuration,\n                  easing: EASING,\n                  useNativeDriver: useNativeDriver!,\n                }),\n              ]).start();\n            }\n          );\n        }\n      );\n    }\n  };\n\n  /**\n   * hides the tooltip\n   *\n   * @param onHidden\n   */\n  const hide = () => {\n    Animated.timing(state.opacityAnimation, {\n      toValue: 0,\n      duration: animationDuration,\n      easing: EASING,\n      useNativeDriver: useNativeDriver!,\n    }).start(() => {\n      setState({\n        ...state,\n        visible: STATES.HIDDEN,\n        marginAnimation: new Animated.Value(-8),\n        opacityAnimation: new Animated.Value(0),\n      });\n    });\n  };\n\n  /**\n   * exposing functions to parent\n   */\n  useImperativeHandle(ref, () => ({\n    show() {\n      show();\n    },\n    hide() {\n      hide();\n    },\n  }));\n\n  return (\n    <View ref={container} onLayout={() => null}>\n      <View>{children}</View>\n      <Modal\n        visible={modalVisible}\n        onRequestClose={hide}\n        supportedOrientations={[\n          'portrait',\n          'portrait-upside-down',\n          'landscape',\n          'landscape-left',\n          'landscape-right',\n        ]}\n        transparent\n        onDismiss={onDismiss}\n      >\n        <TouchableWithoutFeedback onPress={hide} accessible={false}>\n          <View style={StyleSheet.absoluteFill}>\n            <Animated.View\n              style={[\n                styles.shadowMenuContainer,\n                shadowMenuContainerStyle,\n                style,\n              ]}\n            >\n              <Triangle invert={invert} style={computedStyle.triangle} />\n              <Animated.View style={computedStyle.container}>\n                {typeof text === 'string' ? (\n                  <Text {...rest}>{text}</Text>\n                ) : (\n                  text\n                )}\n              </Animated.View>\n            </Animated.View>\n          </View>\n        </TouchableWithoutFeedback>\n      </Modal>\n    </View>\n  );\n});\n\n// Tooltip.defaultProps = {\n//   animationDuration: 300,\n//   bg: 'gray900',\n//   color: 'white',\n//   p: 'md',\n//   rounded: 'xl',\n//   mx: 'lg',\n//   minW: 50,\n//   zIndex: 1,\n//   fontSize: 'md',\n//   useNativeDriver: false,\n// };\n\nconst styles = StyleSheet.create({\n  shadowMenuContainer: {\n    position: 'absolute',\n    backgroundColor: 'transparent',\n    borderRadius: 4,\n    opacity: 0,\n    width: '100%',\n  },\n  menuContainer: {\n    overflow: 'hidden',\n  },\n});\n\nexport { Tooltip };\n"],"mappings":"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"}