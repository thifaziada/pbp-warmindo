{"version":3,"names":["React","useRef","useImperativeHandle","View","Modal","Easing","Animated","StatusBar","StyleSheet","TouchableWithoutFeedback","getStyle","useTheme","Text","Triangle","useStateCallback","WINDOW_HEIGHT","useDefaultProps","STATES","HIDDEN","ANIMATING","SHOWN","EASING","bezier","SCREEN_INDENT","Tooltip","forwardRef","incomingProps","ref","props","animationDuration","bg","color","p","rounded","mx","minW","zIndex","fontSize","useNativeDriver","container","state","setState","visible","top","left","menuWidth","menuHeight","buttonWidth","buttonHeight","marginAnimation","Value","opacityAnimation","windowHeight","currentHeight","invert","shadowMenuContainerStyle","opacity","marginTop","text","style","children","rest","animationStarted","modalVisible","theme","computedStyle","onDismiss","show","current","measureInWindow","parallel","timing","toValue","duration","easing","start","hide","absoluteFill","styles","shadowMenuContainer","triangle","create","position","backgroundColor","borderRadius","width","menuContainer","overflow"],"sources":["tooltip.component.tsx"],"sourcesContent":["import * as React from 'react';\nimport { useRef, useImperativeHandle } from 'react';\nimport {\n  View,\n  Modal,\n  Easing,\n  Animated,\n  StatusBar,\n  StyleSheet,\n  TouchableWithoutFeedback,\n} from 'react-native';\n\nimport { getStyle } from './tooltip.style';\nimport { useTheme } from '../../theme';\nimport { Text } from '../text/text.component';\nimport { Triangle } from './triangle.component';\nimport { TooltipProps, TooltipRef } from './tooltip.type';\nimport { useStateCallback, WINDOW_HEIGHT } from '../../utilities';\nimport { useDefaultProps } from '../../utilities/useDefaultProps';\n\nconst STATES = {\n  HIDDEN: 'HIDDEN',\n  ANIMATING: 'ANIMATING',\n  SHOWN: 'SHOWN',\n};\n\nconst EASING = Easing.bezier(0.4, 0, 0.2, 1);\nconst SCREEN_INDENT = 8;\n\nconst Tooltip = React.forwardRef<\n  TooltipRef,\n  React.PropsWithChildren<TooltipProps>\n>((incomingProps, ref) => {\n  const props = useDefaultProps('Tooltip', incomingProps, {\n    animationDuration: 300,\n    bg: 'gray900',\n    color: 'white',\n    p: 'md',\n    rounded: 'xl',\n    mx: 'lg',\n    minW: 50,\n    zIndex: 1,\n    fontSize: 'md',\n    useNativeDriver: false,\n  });\n\n  const container = useRef<View>(null);\n  const [state, setState] = useStateCallback({\n    visible: STATES.HIDDEN,\n    top: 0,\n    left: 0,\n    menuWidth: 0,\n    menuHeight: 0,\n    buttonWidth: 0,\n    buttonHeight: 0,\n    marginAnimation: new Animated.Value(-8),\n    opacityAnimation: new Animated.Value(0),\n  });\n  const {\n    visible,\n    menuHeight,\n    buttonHeight,\n    opacityAnimation,\n    marginAnimation,\n  } = state;\n  let { top } = state;\n  const windowHeight = WINDOW_HEIGHT - (StatusBar.currentHeight ?? 0);\n  let invert = false;\n  if (top + menuHeight + buttonHeight + SCREEN_INDENT > windowHeight) {\n    top = top - menuHeight - SCREEN_INDENT;\n    invert = true;\n  } else if (top < SCREEN_INDENT) {\n    top = SCREEN_INDENT + buttonHeight;\n  } else {\n    top = top + buttonHeight + SCREEN_INDENT;\n    invert = false;\n  }\n  const shadowMenuContainerStyle = {\n    opacity: opacityAnimation,\n    top,\n    marginTop: marginAnimation,\n  };\n  const {\n    text,\n    style,\n    children,\n    bg,\n    animationDuration,\n    useNativeDriver,\n    ...rest\n  } = props;\n  const animationStarted = visible === STATES.ANIMATING;\n  const modalVisible = visible === STATES.SHOWN || animationStarted;\n  const { theme } = useTheme();\n  const computedStyle = getStyle(theme, props, {\n    ...state,\n    invert,\n  });\n\n  /**\n   * on dismissal of tooltip\n   *\n   * TODO: add onDismiss event\n   */\n  const onDismiss = () => {};\n\n  /**\n   * shows the tooltip\n   */\n  const show = () => {\n    if (container.current) {\n      container.current.measureInWindow(\n        (left: any, top: any, buttonWidth: any, buttonHeight: any) => {\n          setState(\n            {\n              ...state,\n              buttonHeight,\n              buttonWidth,\n              left,\n              visible: STATES.SHOWN,\n              top,\n            },\n            () => {\n              Animated.parallel([\n                Animated.timing(state.marginAnimation, {\n                  toValue: 0,\n                  duration: animationDuration,\n                  easing: EASING,\n                  useNativeDriver: useNativeDriver!,\n                }),\n                Animated.timing(state.opacityAnimation, {\n                  toValue: 1,\n                  duration: animationDuration,\n                  easing: EASING,\n                  useNativeDriver: useNativeDriver!,\n                }),\n              ]).start();\n            }\n          );\n        }\n      );\n    }\n  };\n\n  /**\n   * hides the tooltip\n   *\n   * @param onHidden\n   */\n  const hide = () => {\n    Animated.timing(state.opacityAnimation, {\n      toValue: 0,\n      duration: animationDuration,\n      easing: EASING,\n      useNativeDriver: useNativeDriver!,\n    }).start(() => {\n      setState({\n        ...state,\n        visible: STATES.HIDDEN,\n        marginAnimation: new Animated.Value(-8),\n        opacityAnimation: new Animated.Value(0),\n      });\n    });\n  };\n\n  /**\n   * exposing functions to parent\n   */\n  useImperativeHandle(ref, () => ({\n    show() {\n      show();\n    },\n    hide() {\n      hide();\n    },\n  }));\n\n  return (\n    <View ref={container} onLayout={() => null}>\n      <View>{children}</View>\n      <Modal\n        visible={modalVisible}\n        onRequestClose={hide}\n        supportedOrientations={[\n          'portrait',\n          'portrait-upside-down',\n          'landscape',\n          'landscape-left',\n          'landscape-right',\n        ]}\n        transparent\n        onDismiss={onDismiss}\n      >\n        <TouchableWithoutFeedback onPress={hide} accessible={false}>\n          <View style={StyleSheet.absoluteFill}>\n            <Animated.View\n              style={[\n                styles.shadowMenuContainer,\n                shadowMenuContainerStyle,\n                style,\n              ]}\n            >\n              <Triangle invert={invert} style={computedStyle.triangle} />\n              <Animated.View style={computedStyle.container}>\n                {typeof text === 'string' ? (\n                  <Text {...rest}>{text}</Text>\n                ) : (\n                  text\n                )}\n              </Animated.View>\n            </Animated.View>\n          </View>\n        </TouchableWithoutFeedback>\n      </Modal>\n    </View>\n  );\n});\n\n// Tooltip.defaultProps = {\n//   animationDuration: 300,\n//   bg: 'gray900',\n//   color: 'white',\n//   p: 'md',\n//   rounded: 'xl',\n//   mx: 'lg',\n//   minW: 50,\n//   zIndex: 1,\n//   fontSize: 'md',\n//   useNativeDriver: false,\n// };\n\nconst styles = StyleSheet.create({\n  shadowMenuContainer: {\n    position: 'absolute',\n    backgroundColor: 'transparent',\n    borderRadius: 4,\n    opacity: 0,\n    width: '100%',\n  },\n  menuContainer: {\n    overflow: 'hidden',\n  },\n});\n\nexport { Tooltip };\n"],"mappings":"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"}